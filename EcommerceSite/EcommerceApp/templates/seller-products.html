{% extends 'dashboard_base.html' %}

{% block title %}RetroPik Products{% endblock %}
{% block page_title %}Manage Your Products{% endblock %}

{% block content %}
<div class="products-container">
    <div class="products-header">  
        <h2><i class="fa-solid fa-hand-holding-heart"></i> Your Products</h2>
        <a href="{% url 'add-product' %}" class="btn-add"><i class="fa-solid fa-plus"></i> Add Product</a>
    </div>
    
    {% if products %}
    <div class="product-stack">
        {% for product in products %}
        <div class="product-card">
            <div class="product-content">
                <img src="{{ product.image.url }}" alt="{{ product.name }}">
                <div class="product-details">
                    <h3>{{ product.name }}</h3>
                    <p><b>Price:</b> Php {{ product.price }}</p>
                    <p><b>Stock:</b> {{ product.stock }}</p>
                    <p><b>Description:</b></p>
                    <div class="product-description">
                        <p class="short-description">
                            {{ product.description|truncatechars:120 }}
                        </p>
                        {% if product.description|length > 120 %}
                        <p class="full-description" style="display: none;">
                            {{ product.description }}
                        </p>
                        <span class="toggle-description" onclick="toggleDescription(this)">
                            Read More
                        </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            <div class="product-actions">
                <a href="{% url 'modify-product' product.id %}" class="btn-modify">
                    <i class="fa-solid fa-pen-to-square"></i> Modify
                </a>
                <a href="{% url 'delete-product' product.id %}" class="btn-delete"
                    onclick="return confirm('Are you sure you want to delete this product?');">
                    <i class="fa-solid fa-trash"></i> Delete
                </a>
            </div>
        </div>
        {% endfor %}
    </div>    
    {% else %}
    <div class="no-products">
        <p><i class="fa-solid fa-box-open"></i>  You haven't added any products yet.</p>
    </div>
    {% endif %}
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    function toggleDescription(toggleElement) {
        const $container = $(toggleElement).parent();
        const $shortDesc = $container.find('.short-description');
        const $fullDesc = $container.find('.full-description');

        if ($fullDesc.is(':visible')) {
        $fullDesc.fadeOut(200, function() {
            $shortDesc.fadeIn(200);
        });
        $(toggleElement).text('Read More');
        } else {
            $shortDesc.fadeOut(200, function() {
                $fullDesc.fadeIn(200);
            });
            $(toggleElement).text('Show Less');
        }
    }
</script>

{% endblock %}